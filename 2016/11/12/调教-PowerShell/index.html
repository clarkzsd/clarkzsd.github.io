<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    

    <title>
      调教 PowerShell | Clark&#39;s Blog 
    </title>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    
      <meta name="author" content="Clark Zhou">
    
    

    <meta name="description" content="PowerShellWindows 一直以来都被很多非微软系程序员诟病，莫名奇妙的 bug 太多啊，经常蓝屏啊（这个是所有人都吐槽的），terminal 太弱太丑啊……的确，Windows 不是完美的系统，但也不至于说它彻底不适合开发。环境条件不行（待议），但人行啊，事在人为对不对。 对于程序员来说，terminal ">
<meta name="keywords" content="windows">
<meta property="og:type" content="article">
<meta property="og:title" content="调教 PowerShell | Clark&#39;s Blog">
<meta property="og:url" content="http://zhoushidong.cc/2016/11/12/调教-PowerShell/index.html">
<meta property="og:site_name" content="Clark&#39;s Blog">
<meta property="og:description" content="PowerShellWindows 一直以来都被很多非微软系程序员诟病，莫名奇妙的 bug 太多啊，经常蓝屏啊（这个是所有人都吐槽的），terminal 太弱太丑啊……的确，Windows 不是完美的系统，但也不至于说它彻底不适合开发。环境条件不行（待议），但人行啊，事在人为对不对。 对于程序员来说，terminal 是一个很重要的工具，其颜值和易用性很大一部分决定了开发效率的高低，在 Windo">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://upload.wikimedia.org/wikipedia/commons/d/d5/Windows_PowerShell_1.0_PD.png">
<meta property="og:image" content="http://o6ljw8wcq.bkt.clouddn.com/newblog/pic/powershell/powershell.png">
<meta property="og:image" content="http://o6ljw8wcq.bkt.clouddn.com/teri.png">
<meta property="og:image" content="http://o6ljw8wcq.bkt.clouddn.com/tada.png">
<meta property="og:image" content="https://pic3.zhimg.com/6cedca4b2468fa82352539ae5a9e1e7a_b.png">
<meta property="og:updated_time" content="2017-02-22T10:07:14.337Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="调教 PowerShell | Clark&#39;s Blog">
<meta name="twitter:description" content="PowerShellWindows 一直以来都被很多非微软系程序员诟病，莫名奇妙的 bug 太多啊，经常蓝屏啊（这个是所有人都吐槽的），terminal 太弱太丑啊……的确，Windows 不是完美的系统，但也不至于说它彻底不适合开发。环境条件不行（待议），但人行啊，事在人为对不对。 对于程序员来说，terminal 是一个很重要的工具，其颜值和易用性很大一部分决定了开发效率的高低，在 Windo">
<meta name="twitter:image" content="https://upload.wikimedia.org/wikipedia/commons/d/d5/Windows_PowerShell_1.0_PD.png">
    
    
    
      <link rel="icon" type="image/x-icon" href="/favicon.png">
    
    <link rel="stylesheet" href="/css/uno.css">
    <link rel="stylesheet" href="/css/highlight.css">
    <link rel="stylesheet" href="/css/archive.css">
    <link rel="stylesheet" href="/css/china-social-icon.css">

</head>
<body>

    <span class="mobile btn-mobile-menu">
        <i class="icon icon-list btn-mobile-menu__icon"></i>
        <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
    </span>

    

<header class="panel-cover panel-cover--collapsed">


  <div class="panel-main">

  
    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        

        <h1 class="panel-cover__title panel-title"><a href="/" title="link to homepage">Clark&#39;s Blog</a></h1>
        <hr class="panel-cover__divider" />

        

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">

              
                
                <li class="navigation__item"><a href="/#blog" title="" class="blog-button">首页</a></li>
              
                
                <li class="navigation__item"><a href="/about" title="" class="">关于</a></li>
              
                
                <li class="navigation__item"><a href="/archives" title="" class="">归档</a></li>
              

            </ul>
          </nav>

          <!-- ----------------------------
To add a new social icon simply duplicate one of the list items from below
and change the class in the <i> tag to match the desired social network
and then add your link to the <a>. Here is a full list of social network
classes that you can use:

    icon-social-500px
    icon-social-behance
    icon-social-delicious
    icon-social-designer-news
    icon-social-deviant-art
    icon-social-digg
    icon-social-dribbble
    icon-social-facebook
    icon-social-flickr
    icon-social-forrst
    icon-social-foursquare
    icon-social-github
    icon-social-google-plus
    icon-social-hi5
    icon-social-instagram
    icon-social-lastfm
    icon-social-linkedin
    icon-social-medium
    icon-social-myspace
    icon-social-path
    icon-social-pinterest
    icon-social-rdio
    icon-social-reddit
    icon-social-skype
    icon-social-spotify
    icon-social-stack-overflow
    icon-social-steam
    icon-social-stumbleupon
    icon-social-treehouse
    icon-social-tumblr
    icon-social-twitter
    icon-social-vimeo
    icon-social-xbox
    icon-social-yelp
    icon-social-youtube
    icon-social-zerply
    icon-mail

-------------------------------->

<!-- add social info here -->



<nav class="cover-navigation navigation--social">
  <ul class="navigation">

    
      <!-- Github -->
      <li class="navigation__item">
        <a href="https://github.com/clarkzsd" title="GitHub">
          <i class='icon icon-social-github'></i>
          <span class="label">GitHub</span>
        </a>
      </li>
    

    
      <!-- instagram -->
      <li class="navigation__item">
        <a href="https://www.instagram.com/sytone" title="instagram">
          <i class='icon icon-social-instagram'></i>
          <span class="label">instagram</span>
        </a>
      </li>
    

    
      <!-- instagram -->
      <li class="navigation__item">
        <a href="https://twitter.com/sytonechou" title="twitter">
          <i class='icon icon-social-twitter'></i>
          <span class="label">twitter</span>
        </a>
      </li>
    


  </ul>
</nav>



        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>

    <div class="content-wrapper">
        <div class="content-wrapper__inner entry">
            

<article class="post-container post-container--single">

  <header class="post-header">
    
    <h1 class="post-title">调教 PowerShell</h1>

    

    <div class="post-meta">
      <time datetime="2016-11-12" class="post-meta__date date">2016-11-12</time> 

      <span class="post-meta__tags tags">

          
            <font class="categories">
            &#8226; 分类:
            <a class="categories-link" href="/categories/Tech/">Tech</a>
            </font>
          

          
             &#8226; 标签:
            <font class="tags">
              <a class="tags-link" href="/tags/windows/">windows</a>
            </font>
          

      </span>
    </div>
    
    

  </header>

  <section id="post-content" class="article-content post">
    <h2 id="PowerShell"><a href="#PowerShell" class="headerlink" title="PowerShell"></a>PowerShell</h2><p>Windows 一直以来都被很多非微软系程序员诟病，莫名奇妙的 bug 太多啊，经常蓝屏啊（这个是所有人都吐槽的），terminal 太弱太丑啊……的确，Windows 不是完美的系统，但也不至于说它彻底不适合开发。环境条件不行（待议），但人行啊，事在人为对不对。</p>
<p>对于程序员来说，terminal 是一个很重要的工具，其颜值和易用性很大一部分决定了开发效率的高低，在 Windows 上有两个 terminal ，很多人只知道黑不溜秋的cmd，却不知道高大上的Powershell 。</p>
<blockquote>
<p><strong>Windows PowerShell</strong>是<a href="https://zh.wikipedia.org/wiki/%E5%BE%AE%E8%BD%AF%E5%85%AC%E5%8F%B8" target="_blank" rel="noopener">微软公司</a>为<a href="https://zh.wikipedia.org/wiki/Windows" target="_blank" rel="noopener">Windows</a>环境所开发的<a href="https://zh.wikipedia.org/wiki/%E6%AE%BC%E7%A8%8B%E5%BC%8F" target="_blank" rel="noopener">壳程序</a>（<a href="https://zh.wikipedia.org/wiki/Shell" target="_blank" rel="noopener">shell</a>）及<a href="https://zh.wikipedia.org/wiki/%E8%85%B3%E6%9C%AC%E8%AA%9E%E8%A8%80" target="_blank" rel="noopener">脚本语言</a>技术，采用的是<a href="https://zh.wikipedia.org/wiki/%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%95%8C%E9%9D%A2" target="_blank" rel="noopener">命令行界面</a>。这项全新的技术提供了丰富的控制与<a href="https://zh.wikipedia.org/wiki/%E8%87%AA%E5%8B%95%E5%8C%96" target="_blank" rel="noopener">自动化</a>的系统管理能力。</p>
<p><a href="https://zh.wikipedia.org/wiki/UNIX" target="_blank" rel="noopener">UNIX</a>系统一直有着功能强大的壳程序（<a href="https://zh.wikipedia.org/wiki/Shell" target="_blank" rel="noopener">shell</a>），Windows PowerShell的诞生就是要提供功能相当于UNIX系统的命令行壳程序（例如：<a href="https://zh.wikipedia.org/wiki/Bourne_shell" target="_blank" rel="noopener">sh</a>、<a href="https://zh.wikipedia.org/wiki/Bash" target="_blank" rel="noopener">bash</a>或<a href="https://zh.wikipedia.org/wiki/C_shell" target="_blank" rel="noopener">csh</a>），同时也内置脚本语言以及辅助脚本程序的工具。</p>
</blockquote>
<p>​ ——From <a href="https://zh.wikipedia.org/wiki/Windows_PowerShell" target="_blank" rel="noopener">维基百科</a></p>
<p><a href="https://upload.wikimedia.org/wikipedia/commons/d/d5/Windows_PowerShell_1.0_PD.png" target="_blank" rel="noopener"><img src="https://upload.wikimedia.org/wikipedia/commons/d/d5/Windows_PowerShell_1.0_PD.png" alt="Windows PowerShell 1.0 PD.png"></a>Windows PowerShell 1.0 PD.png</p>
<p>powershell的默认界面是这个样子的，还是丑，对不对？丑没关系，我们可以调教啊</p>
<h2 id="Step1-自定义界面"><a href="#Step1-自定义界面" class="headerlink" title="Step1 自定义界面"></a>Step1 自定义界面</h2><p>其实powershell 是支持自定义界面的</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">右键工具栏-&gt;属性</span><br></pre></td></tr></table></figure>
<p><a href="http://o6ljw8wcq.bkt.clouddn.com/newblog/pic/powershell/powershell.png" target="_blank" rel="noopener"><img src="http://o6ljw8wcq.bkt.clouddn.com/newblog/pic/powershell/powershell.png" alt="powerrshell settings"></a>powerrshell settings</p>
<p>这个厉害了，字体、布局、颜色都可以自定义。</p>
<p>下面给出我配置的颜色及字体大小仅供参考：</p>
<blockquote>
<p>屏幕背景：RGB(0,0,0)</p>
<p>屏幕文字：RGB(0,255,0)</p>
<p>不透明度：70%</p>
<p>字体大小：16</p>
</blockquote>
<p>关于字体，微软对控制台字体的元数据有严格限制。</p>
<blockquote>
<p>这些字体必须满足以下条件，可在命令会话窗口中：<br>　该字体必须是等宽字体。<br>　该字体不能为斜体字体。<br>　该字体不能有A或C负空间。<br>　如果是 TrueType 字体，则它必须是 FF_MODERN。<br>　如果它不是 TrueType 字体，则它必须是 OEM_CHARSET。<br>对于亚洲字体的附加条件：<br>　如果不是 TrueType 字体，字体名必须是“Terminal”。<br>　如果它是亚洲的 TrueType 字体，它还必须使用亚洲语言的字符集。</p>
</blockquote>
<p>所以很多自带的字体都用不了，往往特别设计的字体才能支持控制台模式。这里推荐<a href="https://www.zhihu.com/people/be5invis" target="_blank" rel="noopener">Belleve</a>大神做的<a href="https://link.zhihu.com/?target=http%3A//be5invis.github.io/Iosevka/inziu.html" target="_blank" rel="noopener">Inziu Iosevka</a>字体，（其中，Inziu Iosevka SC/TC/J 和 Inziu IosevkaCC SC/TC/J 可以用于Terminal）</p>
<p>我用的是 Inziu Iosevka SC，设置完字体，效果是大概是这样的：</p>
<p><a href="http://o6ljw8wcq.bkt.clouddn.com/teri.png" target="_blank" rel="noopener"><img src="http://o6ljw8wcq.bkt.clouddn.com/teri.png" alt="MyPowerShell"></a>MyPowerShell</p>
<p>变好看了许多，对不对！</p>
<h2 id="Step2-posh-git-power-theme"><a href="#Step2-posh-git-power-theme" class="headerlink" title="Step2 posh-git + power-theme"></a>Step2 posh-git + power-theme</h2><p>posh-git 能让你在 PowerShell 中优雅的使用 Git。</p>
<blockquote>
<p>Posh-git: A set of PowerShell scripts which provide Git/PowerShell integration.</p>
<h4 id="Prompt-for-Git-repositories"><a href="#Prompt-for-Git-repositories" class="headerlink" title="Prompt for Git repositories"></a>Prompt for Git repositories</h4><p>The prompt within Git repositories can show the current branch and the state of files (additions, modifications, deletions) within.</p>
</blockquote>
<p>它能更改 Git 仓库中命令提示符的外观样式，让你直接能看到当前仓库的状态。</p>
<h3 id="Pre-requisites"><a href="#Pre-requisites" class="headerlink" title="Pre-requisites"></a>Pre-requisites</h3><p>检查 PowerShell 的执行策略是否允许执行未知脚本，以管理员身份打开PowerShell，输入：</p>
<p><code>Set-ExecutionPolicy RemoteSigned</code></p>
<h3 id="安装-posh-git"><a href="#安装-posh-git" class="headerlink" title="安装 posh-git"></a>安装 posh-git</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Install-Module posh-git -Scope CurrentUser</span><br></pre></td></tr></table></figure>
<h3 id="power-theme"><a href="#power-theme" class="headerlink" title="power-theme"></a>power-theme</h3><p>power-theme 是<a href="https://www.zhihu.com/people/chantisnake" target="_blank" rel="noopener">章程</a>写的 PowerShell 命令提示符样式主题， 用了之后进一步提升 PowerShell 的颜值。如果你懂 PowerShell 脚本的话，还可以自己写样式。</p>
<p>power-theme 的github 地址 ：<a href="https://github.com/chantisnake/power-theme" target="_blank" rel="noopener">https://github.com/chantisnake/power-theme</a></p>
<p>安装：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/chantisnake/power-theme <span class="string">"<span class="variable">$($($env:PSModulePath -split ';')</span>[0])\power-theme"</span></span><br></pre></td></tr></table></figure>
<p>启动 theme，这里是个例子，我选的是 ys 主题：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">notepad <span class="variable">$PROFILE</span></span><br></pre></td></tr></table></figure>
<p>然后在这个文件中添加以下命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Import-Module power-theme</span><br><span class="line"></span><br><span class="line">Enable-Theme ys   </span><br><span class="line"></span><br><span class="line"><span class="comment"># 这个可以更改路径样式，有 concise, full 和 folder 三个选项</span></span><br><span class="line"><span class="comment"># 其中 concise 代表省略路径</span></span><br><span class="line"><span class="variable">$Global</span>:THEME.PathFormat = <span class="string">'concise'</span></span><br></pre></td></tr></table></figure>
<p>我配置完的 PowerShell 完是这个样子的：</p>
<p><a href="http://o6ljw8wcq.bkt.clouddn.com/tada.png" target="_blank" rel="noopener"><img src="http://o6ljw8wcq.bkt.clouddn.com/tada.png" alt="FinishedPS"></a></p>
<p>是不是Bigger than bigger ？</p>
<p>它还可以自己添加时间样式</p>
<p><a href="https://pic3.zhimg.com/6cedca4b2468fa82352539ae5a9e1e7a_b.png" target="_blank" rel="noopener"><img src="https://pic3.zhimg.com/6cedca4b2468fa82352539ae5a9e1e7a_b.png" alt="img"></a></p>
<p>具体操作可以查看它的 github 仓库。</p>
<h2 id="Step3-oh-my-posh-ConEmu"><a href="#Step3-oh-my-posh-ConEmu" class="headerlink" title="Step3 oh-my-posh + ConEmu"></a>Step3 oh-my-posh + ConEmu</h2><p>其实还有比 power-theme 更加厉害的东西，那就是 oh-my-posh 。</p>
<p>如果你玩过 *nix 的shell，那么你肯定知道 oh-my-zsh。在 Windows平台，PowerShell 有自己的 <a href="https://github.com/JanJoris/oh-my-posh" target="_blank" rel="noopener">oh-my-posh</a>。只不过，这东西只能在 ConEmu 环境下才有用。（补：power-theme 有些主题也需要在 ConEmu 中才有效）</p>
<blockquote>
<p>ConEmu是一个带标签的Windows终端，提供多标签支持和丰富的自定义选项，是Windows下不可多得的Console.</p>
</blockquote>
<p>ConEmu 的确很强大，但我还是偏爱原生的 PowerShell，所以就没有用 oh-my-posh。有兴趣的朋友可以自己去尝试一下。</p>

  </section>

  <section class="post-comments">

    <!-- 将评论系统（例如Disqus、多说、友言、畅言等）提供的代码片段粘贴在这里 -->
    <div id="disqus_thread"></div>
        <script>

        /**
        *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
        *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
        /*
        var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        };
        */
        (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://clarkzsd.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
        })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>


</article>


            <footer class="footer">

    <span class="footer__copyright">&copy; 2014-2015. | 由<a href="https://hexo.io/">Hexo</a>强力驱动 | 主题<a href="https://github.com/someus/huno">Huno</a></span>
    
</footer>
        </div>
    </div>

    <!-- js files -->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/main.js"></script>
    <script src="/js/scale.fix.js"></script>
    

    

    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript"> 
        $(document).ready(function(){
            MathJax.Hub.Config({ 
                tex2jax: {inlineMath: [['[latex]','[/latex]'], ['\\(','\\)']]} 
            });
        });
    </script>


    

    <script src="/js/awesome-toc.min.js"></script>
    <script>
        $(document).ready(function(){
            $.awesome_toc({
                overlay: true,
                contentId: "post-content",
            });
        });
    </script>


    
    
    <!--kill ie6 -->
<!--[if IE 6]>
  <script src="//letskillie6.googlecode.com/svn/trunk/2/zh_CN.js"></script>
<![endif]-->

</body>
</html>
